tinymce.PluginManager.requireLangPack('vnsmedia', 'vi');
tinymce.PluginManager.add('vnsmedia', function(editor, url) {
    // Add a button that opens a window
    editor.addButton('vnsmedia', {
        title: 'Insert media',
        icon: 'medias',
        onclick: function() {
            var vnsMedia = angular.element(document.body).injector().get('vnsMedia');
            var dlg = vnsMedia.dialog();
            dlg.result.then(function(medias){
                angular.forEach(medias, function(val, key) {
                    var img = '<img src="' + val.source + '" alt="' + val.name + '" data-id="' + val.id + '" data-size="source" />';
                    editor.insertContent(editor.settings.pagebreak_split_block ? "<p>" + img + "</p>" : img);
                });
            });
        }
    });
});